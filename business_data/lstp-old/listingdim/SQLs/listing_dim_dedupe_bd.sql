WITH edw_listings AS
(
select
row_number() OVER (PARTITION BY listingid ORDER BY  listingdimkey ASC) AS row_number_seq,
isaolsyndication,
masterplanid,
specid,
listingnumberofbedrooms,
listingaddress,
dapendingflag,
listingpricereduceddate,
buyeragentsourcealiasid,
listingsourcealiasid,
isvirtualtour,
buyerofficesourcealiasid,
ischoiceenabled,
listingsquarefeet,
hascobroke,
listingid,
openhouseenddate,
listingcoofficesourcealiasid,
listingofficesourcealiasid,
listingcounty,
listingenddate,
listingoriginalprice,
createdby,
ispricedropped,
producttypedimkey,
buyeragentofficedatasourceid,
listingcoagentsourcealiasid,
listingagentsourcealiasid,
listingprovider,
listingstatus,
systemcreationdate,
listingstatuschangeddate,
listingnumberofbathrooms,
listingpostalcode,
listingrentalprice,
listingcity,
listingcoagentofficedatasourceid,
listingpriceincreaseddate,
listinggeoapproximation,
newconstructionflag,
listingsolddate,
listingphotocount,
modifiedby,
rowversion,
listingrawstatus,
createddate,
listinglotsquarefeet,
dapendingdate,
modifieddate,
isvideo,
listingpercentagecompleteness,
effectivefrom,
listingsoldprice,
buyercoofficesourcealiasid,
ispriceincreased,
listingagentofficedatasourceid,
fulfillmentgroupbitmask,
listingphotourl,
hascobrokephone,
listingtype,
listingstate,
headline,
specialmessage,
isrental,
listingdatasourceid,
propertydescription,
isrdcsyndication,
isopenhouse,
listingstartdate,
nonmlsflag,
listingdimkey,
listingcountry,
openhousestartdate,
listingcurrentprice,
listingnumberofstories,
isforeclosure,
listingmarketingtype,
effectiveto,
buyercoagentofficedatasourceid,
headline2,
isdisplayed,
udblistingid,
listingstyle,
propertyid,
buyercoagentsourcealiasid,
etl_datatype_processed_ind,
etl_ztg_id,
etl_invalid_details,
etl_rd_arrival_year,
etl_source_partition_timestamp,
etl_partition_key_timestamp,
etl_last_update_timestamp,
etl_rd_arrival_month,
etl_source_filename,
etl_dedupe_md5_checksum,
etl_invalid_criticality_ind,
etl_rd_arrival_hour,
etl_rd_arrival_day,
etl_create_date,
listing_end_datetime,
effective_to_datetime,
created_datetime,
listing_number_of_bathrooms_double,
listing_sold_datetime,
listing_original_price_double,
system_creation_datetime,
listing_lot_square_feet_double,
da_pending_datetime,
effective_from_datetime,
listing_rental_price_double,
listing_square_feet_double,
modified_created_datetime,
listing_status_changed_datetime,
listing_start_datetime,
listing_price_reduced_datetime,
open_house_start_datetime,
open_house_end_datetime,
listing_current_price_double,
listing_price_increased_datetime,
listing_percentage_completeness_double,
listing_sold_price_double,
modified_datetime,
listing_number_of_stories_double,
year,
month,
day,
hour
from
listing_dim_All
)
SELECT
isaolsyndication,
masterplanid,
specid,
listingnumberofbedrooms,
listingaddress,
dapendingflag,
listingpricereduceddate,
buyeragentsourcealiasid,
listingsourcealiasid,
isvirtualtour,
buyerofficesourcealiasid,
ischoiceenabled,
listingsquarefeet,
hascobroke,
listingid,
openhouseenddate,
listingcoofficesourcealiasid,
listingofficesourcealiasid,
listingcounty,
listingenddate,
listingoriginalprice,
createdby,
ispricedropped,
producttypedimkey,
buyeragentofficedatasourceid,
listingcoagentsourcealiasid,
listingagentsourcealiasid,
listingprovider,
listingstatus,
systemcreationdate,
listingstatuschangeddate,
listingnumberofbathrooms,
listingpostalcode,
listingrentalprice,
listingcity,
listingcoagentofficedatasourceid,
listingpriceincreaseddate,
listinggeoapproximation,
newconstructionflag,
listingsolddate,
listingphotocount,
modifiedby,
rowversion,
listingrawstatus,
createddate,
listinglotsquarefeet,
dapendingdate,
modifieddate,
isvideo,
listingpercentagecompleteness,
effectivefrom,
listingsoldprice,
buyercoofficesourcealiasid,
ispriceincreased,
listingagentofficedatasourceid,
fulfillmentgroupbitmask,
listingphotourl,
hascobrokephone,
listingtype,
listingstate,
headline,
specialmessage,
isrental,
listingdatasourceid,
propertydescription,
isrdcsyndication,
isopenhouse,
listingstartdate,
nonmlsflag,
listingdimkey,
listingcountry,
openhousestartdate,
listingcurrentprice,
listingnumberofstories,
isforeclosure,
listingmarketingtype,
effectiveto,
buyercoagentofficedatasourceid,
headline2,
isdisplayed,
udblistingid,
listingstyle,
propertyid,
buyercoagentsourcealiasid,
etl_datatype_processed_ind,
etl_ztg_id,
etl_invalid_details,
etl_rd_arrival_year,
etl_source_partition_timestamp,
etl_partition_key_timestamp,
etl_last_update_timestamp,
etl_rd_arrival_month,
etl_source_filename,
etl_dedupe_md5_checksum,
etl_invalid_criticality_ind,
etl_rd_arrival_hour,
etl_rd_arrival_day,
etl_create_date,
listing_end_datetime,
effective_to_datetime,
created_datetime,
listing_number_of_bathrooms_double,
listing_sold_datetime,
listing_original_price_double,
system_creation_datetime,
listing_lot_square_feet_double,
da_pending_datetime,
effective_from_datetime,
listing_rental_price_double,
listing_square_feet_double,
modified_created_datetime,
listing_status_changed_datetime,
listing_start_datetime,
listing_price_reduced_datetime,
open_house_start_datetime,
open_house_end_datetime,
listing_current_price_double,
listing_price_increased_datetime,
listing_percentage_completeness_double,
listing_sold_price_double,
modified_datetime,
listing_number_of_stories_double,
year,
month,
day,
hour
FROM edw_listings WHERE row_number_seq = 1